var webpack = require('webpack');
var path = require('path');
var loaders = require('./webpack.loaders');
var CopyWebpackPlugin = require('copy-webpack-plugin');

module.exports = {
	entry: [
		'./client/index.js' // Your app ºs entry point
	],
	output: {
		path: path.join(__dirname, 'public'),
		filename: 'bundle.js'
	},
	resolve: {
		extensions: ['', '.js', '.jsx']
	},
	module: {
		loaders: loaders
	},
	plugins: [
	    new CopyWebpackPlugin([
		{from: 'client/index.html',
		 transform: function(content, path){
		     console.log('transforming content!', content);
		     return content.toString().replace(new RegExp('/bundle.js','gim'), 'public/bundle.js')
		 }, to:__dirname}
	    ]),
	    new webpack.DefinePlugin({
			'process.env': {
				NODE_ENV: '"production"'
			}
		})
	]
};
